This code is cloned from VULPY 
